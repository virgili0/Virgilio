<!DOCTYPE html>
<html lang="en-US">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>Evaluation and Fine Tuning | Virgilio</title>
    <meta name="generator" content="VuePress 1.4.1">
    
    <meta name="description" content="Learn how to evaluate your models after the training process, which model to choose depending on your requirements, and how to investigate possible solutions if your model is not learning well.">
    <link rel="preload" href="/Virgilio/assets/css/0.styles.54ba6b1e.css" as="style"><link rel="preload" href="/Virgilio/assets/js/app.7ea56c74.js" as="script"><link rel="preload" href="/Virgilio/assets/js/2.7d66466a.js" as="script"><link rel="preload" href="/Virgilio/assets/js/3.0dad664f.js" as="script"><link rel="preload" href="/Virgilio/assets/js/42.d4377ee7.js" as="script"><link rel="prefetch" href="/Virgilio/assets/js/10.23839acb.js"><link rel="prefetch" href="/Virgilio/assets/js/11.38c00fcb.js"><link rel="prefetch" href="/Virgilio/assets/js/12.c9b73a0e.js"><link rel="prefetch" href="/Virgilio/assets/js/13.23e0b9be.js"><link rel="prefetch" href="/Virgilio/assets/js/14.2f8c1c14.js"><link rel="prefetch" href="/Virgilio/assets/js/15.f2436634.js"><link rel="prefetch" href="/Virgilio/assets/js/16.4dff50b5.js"><link rel="prefetch" href="/Virgilio/assets/js/17.5c66df0a.js"><link rel="prefetch" href="/Virgilio/assets/js/18.9885a6cb.js"><link rel="prefetch" href="/Virgilio/assets/js/19.ab850215.js"><link rel="prefetch" href="/Virgilio/assets/js/20.b47e4aeb.js"><link rel="prefetch" href="/Virgilio/assets/js/21.01fd0efa.js"><link rel="prefetch" href="/Virgilio/assets/js/22.37fc588b.js"><link rel="prefetch" href="/Virgilio/assets/js/23.3cac7c62.js"><link rel="prefetch" href="/Virgilio/assets/js/24.37374766.js"><link rel="prefetch" href="/Virgilio/assets/js/25.d189084b.js"><link rel="prefetch" href="/Virgilio/assets/js/26.a8b99281.js"><link rel="prefetch" href="/Virgilio/assets/js/27.4ddc119c.js"><link rel="prefetch" href="/Virgilio/assets/js/28.061ec001.js"><link rel="prefetch" href="/Virgilio/assets/js/29.9b10c137.js"><link rel="prefetch" href="/Virgilio/assets/js/30.52b56fd9.js"><link rel="prefetch" href="/Virgilio/assets/js/31.49b483fc.js"><link rel="prefetch" href="/Virgilio/assets/js/32.a1788b75.js"><link rel="prefetch" href="/Virgilio/assets/js/33.5f275da3.js"><link rel="prefetch" href="/Virgilio/assets/js/34.8488b836.js"><link rel="prefetch" href="/Virgilio/assets/js/35.2a8773b8.js"><link rel="prefetch" href="/Virgilio/assets/js/36.12791d1f.js"><link rel="prefetch" href="/Virgilio/assets/js/37.ee5b9581.js"><link rel="prefetch" href="/Virgilio/assets/js/38.8f190a16.js"><link rel="prefetch" href="/Virgilio/assets/js/39.b617605f.js"><link rel="prefetch" href="/Virgilio/assets/js/4.ccdcd5a4.js"><link rel="prefetch" href="/Virgilio/assets/js/40.d20592ca.js"><link rel="prefetch" href="/Virgilio/assets/js/41.ca18f159.js"><link rel="prefetch" href="/Virgilio/assets/js/43.b4e0dfd1.js"><link rel="prefetch" href="/Virgilio/assets/js/44.ee370912.js"><link rel="prefetch" href="/Virgilio/assets/js/45.e6fa05f7.js"><link rel="prefetch" href="/Virgilio/assets/js/5.8f407677.js"><link rel="prefetch" href="/Virgilio/assets/js/6.60984f5e.js"><link rel="prefetch" href="/Virgilio/assets/js/7.ffbe5b81.js"><link rel="prefetch" href="/Virgilio/assets/js/8.04f6b6f7.js"><link rel="prefetch" href="/Virgilio/assets/js/9.9fa5ace2.js">
    <link rel="stylesheet" href="/Virgilio/assets/css/0.styles.54ba6b1e.css">
  </head>
  <body>
    <div id="app" data-server-rendered="true"><div class="theme-container"><header class="navbar"><div class="sidebar-button"><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" role="img" viewBox="0 0 448 512" class="icon"><path fill="currentColor" d="M436 124H12c-6.627 0-12-5.373-12-12V80c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12z"></path></svg></div> <a href="/Virgilio/" class="home-link router-link-active"><!----> <span class="site-name">Virgilio <span class="site-name2"> Data Science </span></span></a> <div class="links"><div class="search-box"><input aria-label="Search" autocomplete="off" spellcheck="false" value=""> <!----></div> <nav class="nav-links can-hide"><div class="nav-item"><a href="https://github.com/virgili0/Virgilio" target="_blank" rel="noopener noreferrer" class="nav-link external">
  Contribute
  <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></div> <!----></nav></div></header> <div class="sidebar-mask"></div> <aside class="sidebar"><nav class="nav-links"><div class="nav-item"><a href="https://github.com/virgili0/Virgilio" target="_blank" rel="noopener noreferrer" class="nav-link external">
  Contribute
  <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></div> <!----></nav>  <ul class="sidebar-links"><li><a href="/Virgilio/" class="sidebar-link">What is Virgilio?</a></li><li><section class="sidebar-group depth-0"><p class="sidebar-heading"><span>Paradiso</span> <!----></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/Virgilio/paradiso/demystification-ai-ml-dl.html" class="sidebar-link">Demystification of the key concepts of AI and ML</a></li><li><a href="/Virgilio/paradiso/what-do-i-need-for-ml.html" class="sidebar-link">What do I need to do Machine Learning?</a></li><li><a href="/Virgilio/paradiso/do-you-really-need-ml.html" class="sidebar-link">Do you really need Machine Learning?</a></li><li><a href="/Virgilio/paradiso/use-cases.html" class="sidebar-link">Machine Learning use cases</a></li><li><a href="/Virgilio/paradiso/virgilio-teaching-strategy.html" class="sidebar-link">Virgilio's Teaching Strategy</a></li><li><a href="/Virgilio/paradiso/introduction-to-ml.html" class="sidebar-link">Introduction to Machine Learning</a></li></ul></section></li><li><section class="sidebar-group depth-0"><p class="sidebar-heading open"><span>Purgatorio</span> <!----></p> <ul class="sidebar-links sidebar-group-items"><li><section class="sidebar-group is-sub-group depth-1"><p class="sidebar-heading"><span>Fundamentals</span> <!----></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/Virgilio/purgatorio/fundamentals/math-fundamentals.html" class="sidebar-link">Linear Algebra</a></li><li><a href="/Virgilio/purgatorio/fundamentals/statistics-fundamentals.html" class="sidebar-link">Statistics</a></li><li><a href="/Virgilio/purgatorio/fundamentals/python-fundamentals.html" class="sidebar-link">Python</a></li><li><a href="/Virgilio/purgatorio/fundamentals/jupyter-notebook.html" class="sidebar-link">Jupyter Notebook</a></li><li><a href="/Virgilio/purgatorio/fundamentals/the-data-science-process.html" class="sidebar-link">The Data Science Process</a></li></ul></section></li><li><section class="sidebar-group is-sub-group depth-1"><p class="sidebar-heading"><span>Define The Scope and Ask Questions</span> <!----></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/Virgilio/purgatorio/define-the-scope-and-ask-questions/frame-the-problem.html" class="sidebar-link">Frame the Problem</a></li><li><a href="/Virgilio/purgatorio/define-the-scope-and-ask-questions/usage-and-integration.html" class="sidebar-link">Usage and Integration</a></li><li><a href="/Virgilio/purgatorio/define-the-scope-and-ask-questions/starting-a-data-project.html" class="sidebar-link">Starting a Data Project</a></li><li><a href="/Virgilio/purgatorio/define-the-scope-and-ask-questions/workspace-setup-and-cloud-computing.html" class="sidebar-link">Workspace Setup and Cloud Computing</a></li></ul></section></li><li><section class="sidebar-group is-sub-group depth-1"><p class="sidebar-heading"><span>Collect and Prepare Data</span> <!----></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/Virgilio/purgatorio/collect-and-prepare-data/data-preparation.html" class="sidebar-link">Data Preparation</a></li><li><a href="/Virgilio/purgatorio/collect-and-prepare-data/data-visualization.html" class="sidebar-link">Data Visualization</a></li></ul></section></li><li><section class="sidebar-group is-sub-group depth-1"><p class="sidebar-heading open"><span>Select and Train Machine Learning Models</span> <!----></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/Virgilio/purgatorio/select-and-train-machine-learning-models/machine-learning-theory.html" class="sidebar-link">Machine Learning Theory</a></li><li><a href="/Virgilio/purgatorio/select-and-train-machine-learning-models/deep-learning-theory.html" class="sidebar-link">Deep Learning Theory</a></li><li><a href="/Virgilio/purgatorio/select-and-train-machine-learning-models/evaluation-and-finetuning.html" class="active sidebar-link">Evaluation and Fine Tuning</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/Virgilio/purgatorio/select-and-train-machine-learning-models/evaluation-and-finetuning.html#there-is-no-one-ring-to-rule-them-all" class="sidebar-link">There Is No One Ring to Rule them All</a></li><li class="sidebar-sub-header"><a href="/Virgilio/purgatorio/select-and-train-machine-learning-models/evaluation-and-finetuning.html#be-sure-about-the-type-of-problem" class="sidebar-link">Be sure about the type of problem</a></li><li class="sidebar-sub-header"><a href="/Virgilio/purgatorio/select-and-train-machine-learning-models/evaluation-and-finetuning.html#build-a-meaningful-test-set" class="sidebar-link">Build a Meaningful Test Set</a></li><li class="sidebar-sub-header"><a href="/Virgilio/purgatorio/select-and-train-machine-learning-models/evaluation-and-finetuning.html#select-a-metric" class="sidebar-link">Select a Metric</a></li><li class="sidebar-sub-header"><a href="/Virgilio/purgatorio/select-and-train-machine-learning-models/evaluation-and-finetuning.html#evaluate-the-model" class="sidebar-link">Evaluate the Model</a></li><li class="sidebar-sub-header"><a href="/Virgilio/purgatorio/select-and-train-machine-learning-models/evaluation-and-finetuning.html#hyperparameters-tuning" class="sidebar-link">Hyperparameters Tuning</a></li><li class="sidebar-sub-header"><a href="/Virgilio/purgatorio/select-and-train-machine-learning-models/evaluation-and-finetuning.html#conclusions" class="sidebar-link">Conclusions</a></li></ul></li><li><a href="/Virgilio/purgatorio/select-and-train-machine-learning-models/tools-and-libraries.html" class="sidebar-link">Tools and Libraries</a></li></ul></section></li><li><section class="sidebar-group is-sub-group depth-1"><p class="sidebar-heading"><span>Launch and Mantain the System </span> <!----></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/Virgilio/purgatorio/launch-and-mantain-the-system/serving-trained-models.html" class="sidebar-link">Serving Trained Models</a></li></ul></section></li></ul></section></li><li><section class="sidebar-group depth-0"><p class="sidebar-heading"><span>Inferno</span> <!----></p> <ul class="sidebar-links sidebar-group-items"><li><section class="sidebar-group is-sub-group depth-1"><p class="sidebar-heading open"><span>Computer Vision</span> <!----></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/Virgilio/inferno/computer-vision/introduction-to-computer-vision.html" class="sidebar-link">Introduction to Computer Vision using OpenCV and Python</a></li><li><a href="/Virgilio/inferno/computer-vision/object-instance-segmentation.html" class="sidebar-link">Object Instance Segmentation using TensorFlow Framework and Cloud GPU Technology</a></li><li><a href="/Virgilio/inferno/computer-vision/object-tracking.html" class="sidebar-link">Object Tracking based on Deep Learning</a></li><li><a href="/Virgilio/inferno/computer-vision/Object_detection_based_on_Deep_Learning.html" class="sidebar-link">Object detection based on Deep Learning</a></li></ul></section></li><li><section class="sidebar-group is-sub-group depth-1"><p class="sidebar-heading"><span>Tools</span> <!----></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/Virgilio/inferno/tools/geo-gebra.html" class="sidebar-link">Geo Gebra</a></li><li><a href="/Virgilio/inferno/tools/latex.html" class="sidebar-link">LaTex</a></li><li><a href="/Virgilio/inferno/tools/regex.html" class="sidebar-link">Regex introduction</a></li><li><a href="/Virgilio/inferno/tools/wolfram-alpha.html" class="sidebar-link">Wolfram Alpha</a></li></ul></section></li><li><section class="sidebar-group is-sub-group depth-1"><p class="sidebar-heading"><span>Research</span> <!----></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/Virgilio/inferno/research/zotero.html" class="sidebar-link">Zotero</a></li><li><a href="/Virgilio/inferno/research/sota-papers.html" class="sidebar-link">Research papers explained</a></li></ul></section></li></ul></section></li></ul> </aside> <main class="page"> <div class="theme-default-content content__default"><h1 id="index"><a href="#index" class="header-anchor">#</a> Index</h1> <ul><li><a href="#There-Is-No-One-Ring-to-Rule-them-All">There Is No One Ring to Rule them All</a></li> <li><a href="#Be-Sure-About-the-Type-of-the-Problem">Be Sure About the Type of the Problem</a></li> <li><a href="#Build-a-Meaningful-Test-Set">Build a Meaningful Test Set</a></li> <li><a href="#Select-a-Metric">Select a Metric</a></li> <li><a href="#Evaluate-the-Model">Evaluate the Model</a></li> <li><a href="#Hyperparameters-Tuning">Hyperparameters Tuning</a></li> <li><a href="#Conclusions">Conclusions</a></li></ul> <h2 id="there-is-no-one-ring-to-rule-them-all"><a href="#there-is-no-one-ring-to-rule-them-all" class="header-anchor">#</a> There Is No One Ring to Rule them All</h2> <p>In many of Virgilio's guides, you have learned that there is rarely a &quot;best&quot; way to do something, as is common in all engineering disciplines.</p> <p>Data Science doesn't make any difference, on the contrary, it takes to the extreme the concept of <strong>tradeoff</strong>, of &quot;choice&quot; in front of various possibilities, with the best choice often guided by the details of the specific problem.</p> <p>This concept is well illustrated by the <a href="http://www.no-free-lunch.org/" target="_blank" rel="noopener noreferrer">&quot;No Free Lunch Theorem&quot;<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a>, which states</p> <blockquote><p>All algorithms that search for an extremum of a cost function perform the same when averaged over all possible cost functions.</p></blockquote> <p>That is, in human-understandable words, that there's <strong>no one model that can fit every need or solve every problem</strong>.</p> <p>See also: <a href="https://ai.stackexchange.com/questions/15650/what-are-the-implications-of-the-no-free-lunch-theorem-for-machine-learning" target="_blank" rel="noopener noreferrer">What are the implications of the “No Free Lunch” theorem for machine learning?<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></p> <p>Sure, there are <em>certain classes</em> of algorithms that work better for <em>certain classes of problems</em>, or algorithms that have been completely outclassed by more &quot;intelligent&quot; versions, but in general, it is not possible to state this with certainty for every problem.</p> <p>The bottom line is that you must learn how to choose the right algorithm that will give you the best-trained model <em>for your specific problem</em>.</p> <p>How to do this?</p> <p>Well, in this case, the experience plays the master role, and even after years of doing Data Science, you'll find yourself learning new stuff about how an algorithm can perform better or worse given certain conditions.</p> <p>But luckily you can measure algorithm performance on our problem and discover what works best!</p> <p>To do that, you need to do 3 things:</p> <ul><li>Build a meaningful test set</li> <li>Choose the right metric to measure your model performances against it</li> <li>Track the parameters and the associated results with each evaluation</li></ul> <h2 id="be-sure-about-the-type-of-problem"><a href="#be-sure-about-the-type-of-problem" class="header-anchor">#</a> Be sure about the type of problem</h2> <p>It would be impossible to list all the existing types and sub-types of problems, also because some of them can be classified as classification or regression problems depending on the approach!</p> <p>The advice that Virgilio gives you is, therefore, the following:</p> <p>Once you are in front of a problem, understand first <strong>what type</strong> problem you are facing, and <em>from that</em> start to learn, search and understand the metrics that may interest you!</p> <p>Be sure to know what problem you're dealing with, even though you should have done this <em>before start solving the problem</em>:</p> <ul><li><a href="https://developers.google.com/machine-learning/problem-framing/cases" target="_blank" rel="noopener noreferrer">Common ML Problems<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></li></ul> <h2 id="build-a-meaningful-test-set"><a href="#build-a-meaningful-test-set" class="header-anchor">#</a> Build a Meaningful Test Set</h2> <p>To evaluate your model, you should have a clear picture of what kind of &quot;real-world&quot; it will behave in, which means having a test set representative of the actual problem you want to solve.</p> <p>Often, if you pick a pre-built dataset, it comes with a ready-to-go test set, but in real problem scenarios, you don't have that!</p> <p>A technique to generate a test set from a dataset is to <a href="https://stackoverflow.com/questions/37114273/how-to-randomly-split-a-dataset-into-training-set-test-set-and-dev-set-in-pyth" target="_blank" rel="noopener noreferrer">shuffle and randomly draw a set<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a> from it, and this <em>can work</em> for certain situations, but it's not a general rule. This approach assumes that your dataset is balanced, is representative of the real-world problem, and some other details.</p> <p>In general, when you build a test set you should make it:</p> <ul><li>Big enough to draw conclusions about the performance of the model</li> <li>Representative of the real-world scenario in which the model will be deployed</li> <li>Representative of the training set (if not, for sure you won't get good performances)</li> <li>It needs to avoid biases introduced by pre-processing transformations or outlier removal</li></ul> <p>Luckily for us, <a href="https://it.wikipedia.org/wiki/Andrew_Ng" target="_blank" rel="noopener noreferrer">Andrew NG<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a> collected for us all a very exhaustive list of tips and trick to build a meaningful test set, and you can find them in the practical book:</p> <ul><li><a href="https://www.deeplearning.ai/machine-learning-yearning/" target="_blank" rel="noopener noreferrer">Machine Learning Yearning<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></li></ul> <h2 id="select-a-metric"><a href="#select-a-metric" class="header-anchor">#</a> Select a Metric</h2> <p>You know, Google is your friend, and with a 99.99% chance someone will already be in the same situation as you, and probably a simple query like 'ML metric for <strong>type_X</strong> problem' can give you a ton of good answers.</p> <p>A good starting point though can be the following:</p> <ul><li><a href="https://fayrix.com/machine-learning-metrics" target="_blank" rel="noopener noreferrer">Selecting Metrics for Machine Learning<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></li></ul> <p>Even if you can easily find in a lot of literature and good information about each ML metric on Google, be sure to read this presentation about the ML evaluation phase in general:</p> <ul><li><a href="https://www.icmla-conference.org/icmla11/PE_Tutorial.pdf" target="_blank" rel="noopener noreferrer">Performance Evaluation for Learning Algorithms<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></li></ul> <p>Then you can dive deeper into these more detailed resources:</p> <ul><li><a href="https://frnsys.com/ai_notes/machine_learning/model_selection.html" target="_blank" rel="noopener noreferrer">Model Selection and Evaluation<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></li> <li><a href="https://arxiv.org/abs/1809.03006" target="_blank" rel="noopener noreferrer">Performance Metrics (Error Measures) in Machine Learning Regression<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></li></ul> <p>Bonus resources about model evaluation:</p> <ul><li><a href="https://www.youtube.com/watch?v=7RdKnACscjA&amp;t=2374s" target="_blank" rel="noopener noreferrer">Practical Model Evaluation: What matters for your model?<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></li> <li><a href="https://www.youtube.com/watch?v=trg3YkCsjqE" target="_blank" rel="noopener noreferrer">Applied ML 2020 - Model Evaluation and Metrics<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></li></ul> <p>Check this library for testing machine learning models, specifically those in scikit-learn:</p> <ul><li><a href="https://github.com/EricSchles/drifter_ml" target="_blank" rel="noopener noreferrer">Drifter_ML<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></li></ul> <h2 id="evaluate-the-model"><a href="#evaluate-the-model" class="header-anchor">#</a> Evaluate the Model</h2> <p>After you've built your test set, is time to evaluate your trained algorithm against it!</p> <p>But to do that, you should have well clear in mind which is a valuable metric to measure the performance of your algorithms.</p> <p>It turns out that this heavily depends on the problem you are facing, and in particular the type of problem: are you facing a supervised problem or not? If yes, are you solving a classification or regression problem?</p> <p>And so on...</p> <p>To learn how to evaluate your model after the training phase, get through Chapter 6 of the book <a href="http://www.mlebook.com/wiki/doku.php" target="_blank" rel="noopener noreferrer">Machine Learning Engineering<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a> by <a href="https://www.linkedin.com/in/andriyburkov/" target="_blank" rel="noopener noreferrer">Andriy Burkov<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a>:</p> <ul><li><a href="https://www.dropbox.com/s/4ly72ahtz6vsy5n/Chapter6.pdf?dl=0" target="_blank" rel="noopener noreferrer">Chapter 6 - Model Evaluation<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></li></ul> <h2 id="hyperparameters-tuning"><a href="#hyperparameters-tuning" class="header-anchor">#</a> Hyperparameters Tuning</h2> <p>When you evaluate a Machine Learning model, you evaluate a model trained with a certain configuration, and the parameters in this configuration are called <strong>&quot;hyperparameters&quot;</strong>.</p> <p>See also: <a href="https://datascience.stackexchange.com/questions/14187/what-is-the-difference-between-model-hyperparameters-and-model-parameters" target="_blank" rel="noopener noreferrer">What is the difference between model hyperparameters and model parameters?<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></p> <p>**Choosing the right hyperparameters to let the ML algorithm learn well is probably the most difficult job in the Data Science Process (someone calls it &quot;<a href="https://medium.com/@rayheberer/black-magic-and-hyperparameter-tuning-ef875eb31712" target="_blank" rel="noopener noreferrer">Black Magic<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a>&quot;).</p> <p>There are no Golden Rules (<a href="#There-Is-No-One-Ring-to-Rule-them-All">There Is No One Ring to Rule them All</a>), even though some best practices are recognized to work well in a variety of situations.</p> <p>But when you tackle a novel problem, with a custom dataset, it's difficult to choose these hyperparameters right at the first shot.</p> <p>For example, imagine you're training a neural network (even a simple one), you can have <em>a lot</em> of these hyperparameters:
About the topology of the network:</p> <ul><li>the type of layers</li> <li>the number of layers</li> <li>the number of neurons in each layer</li> <li>the activation functions</li></ul> <p>Or about the optimization phase (the actual training):</p> <ul><li>the number of training epochs</li> <li>the batch size</li> <li>the learning rate</li> <li>the learning rate decay</li> <li>regularization techniques</li></ul> <p>What a mess! How to get these right?</p> <p>Often data scientists try to overcome this problem with some techniques, like Grid Search, Random Search, or Evolutionary Algorithms.</p> <p>Be sure to get through the following resources to understand how to tune the hyperparameters of your model!</p> <ul><li><a href="https://community.alteryx.com/t5/Data-Science-Blog/Hyperparameter-Tuning-Black-Magic/ba-p/449289" target="_blank" rel="noopener noreferrer">Introduction to Hyperparameter Tuning<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></li> <li><a href="https://machinelearningmastery.com/grid-search-hyperparameters-deep-learning-models-python-keras/" target="_blank" rel="noopener noreferrer">Grid Search<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></li> <li><a href="https://towardsdatascience.com/feature-selection-by-random-search-in-python-730ffd2912e9" target="_blank" rel="noopener noreferrer">Random Search<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></li> <li><a href="https://scikit-learn.org/stable/modules/cross_validation.html" target="_blank" rel="noopener noreferrer">Cross-validation: evaluating estimator performance - with Scikit-Learn<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></li></ul> <p>Read also:</p> <ul><li><a href="https://stats.stackexchange.com/questions/160479/practical-hyperparameter-optimization-random-vs-grid-search" target="_blank" rel="noopener noreferrer">Practical hyperparameter optimization: Random vs. grid search<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></li> <li><a href="https://blog.floydhub.com/guide-to-hyperparameters-search-for-deep-learning-models/" target="_blank" rel="noopener noreferrer">Practical Guide to Hyperparameters Optimization for Deep Learning Models<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></li> <li><a href="https://blog.tensorflow.org/2020/01/hyperparameter-tuning-with-keras-tuner.html" target="_blank" rel="noopener noreferrer">Hyperparameter tuning with Keras Tuner<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></li></ul> <p>And more advanced techniques:</p> <ul><li><a href="https://arxiv.org/abs/1906.11527" target="_blank" rel="noopener noreferrer">Hyp-RL : Hyperparameter Optimization by Reinforcement Learning<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></li></ul> <p>Remember that these techniques are not meant to substitute the Data Scientist knowledge, but to help him in finding the most promising directions!</p> <p>With the experience, you'll learn by yourself what are likely good configurations, depending on the problem at hand.</p> <p>Even though Hyperparameter Tuning can help, remember that can sometimes give a small/marginal gain over the original metric.</p> <p>The real factors resulting in better metrics/results is always the quality of the dataset.</p> <h2 id="conclusions"><a href="#conclusions" class="header-anchor">#</a> Conclusions</h2> <p>In this guide, you've learned how to choose the right test set for your evaluation, how to choose a meaningful metric for the problem at hand, and how to evaluate the model against it.</p> <p>You've also seen some techniques that help you move in the deep space of the hyperparameters configurations.</p> <p>Now, once you're satisfied by the performance fo your model, you're ready to use it in the real world!</p></div> <footer class="page-edit"><!----> <!----></footer> <div class="page-nav"><p class="inner"><span class="prev">
      ←
      <a href="/Virgilio/purgatorio/select-and-train-machine-learning-models/deep-learning-theory.html" class="prev">
        Deep Learning Theory
      </a></span> <span class="next"><a href="/Virgilio/purgatorio/select-and-train-machine-learning-models/tools-and-libraries.html">
        Tools and Libraries
      </a>
      →
    </span></p></div> </main></div><div class="global-ui"></div></div>
    <script src="/Virgilio/assets/js/app.7ea56c74.js" defer></script><script src="/Virgilio/assets/js/2.7d66466a.js" defer></script><script src="/Virgilio/assets/js/3.0dad664f.js" defer></script><script src="/Virgilio/assets/js/42.d4377ee7.js" defer></script>
  </body>
</html>
